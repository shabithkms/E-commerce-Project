extends ../../../layouts/master.pug

block csslib
	link(href='/admin/assets/plugins/custom/datatables/datatables.bundle.css' rel='stylesheet' type='text/css')

block jslib
	// begin::Vendors Javascript(used by this page)
	script(src='/admin/assets/plugins/custom/datatables/datatables.bundle.js')
	// end::Vendors Javascript
	// begin::Custom Javascript(used by this page)
	script(src='/admin/assets/js/custom/apps/ecommerce/customers/listing/listing.js')
	script(src='/admin/assets/js/custom/apps/ecommerce/customers/listing/add.js')
	script(src='/admin/assets/js/custom/apps/ecommerce/customers/listing/export.js')
	script(src='/admin/assets/js/widgets.bundle.js')
	script(src='/admin/assets/js/custom/widgets.js')
	script(src='/admin/assets/js/custom/apps/chat/chat.js')
	script(src='/admin/assets/js/custom/utilities/modals/upgrade-plan.js')
	script(src='/admin/assets/js/custom/utilities/modals/create-app.js')
	script(src='/admin/assets/js/custom/utilities/modals/users-search.js')
	// end::Custom 

	// Form Submission Script
	script(src='/common/js/form-data-json.min.js')
	script(src='/common/js/es-form.js')

block customScript 
	script.
		//- $("#kt_daterangepicker_1").daterangepicker();
		var start = moment().subtract(29, "days");
		var end = moment();

		function cb(start, end) {
			$("#kt_daterangepicker_1").html(start.format("D MMMM, YYYY") + " - " + end.format("D MMMM, YYYY"));
		}

		$("#kt_daterangepicker_1").daterangepicker({
			startDate: start,
			endDate: end,
			locale: {
				format: "DD/M/Y"
			},
			ranges: {
			"Today": [moment(), moment()],
			"Yesterday": [moment().subtract(1, "days"), moment().subtract(1, "days")],
			"Last 7 Days": [moment().subtract(6, "days"), moment()],
			"Last 30 Days": [moment().subtract(29, "days"), moment()],
			"This Month": [moment().startOf("month"), moment().endOf("month")],
			"Last Month": [moment().subtract(1, "month").startOf("month"), moment().subtract(1, "month").endOf("month")]
			}
		}, cb);

		cb(start, end);


block content
	.d-flex.flex-column.flex-column-fluid
		#kt_app_toolbar.app-toolbar.py-3.py-lg-6
			#kt_app_toolbar_container.app-container.container-xxl.d-flex.flex-stack
				.page-title.d-flex.flex-column.justify-content-center.flex-wrap.me-3
					h1.page-heading.d-flex.text-dark.fw-bold.fs-3.flex-column.justify-content-center.my-0
						| Push Notification
					ul.breadcrumb.breadcrumb-separatorless.fw-semibold.fs-7.my-0.pt-1
						li.breadcrumb-item.text-muted
							a.text-muted.text-hover-primary(href='/admin/dashboard') Home
						li.breadcrumb-item
							span.bullet.bg-gray-400.w-5px.h-2px
						li.breadcrumb-item.text-muted eCommerce
						li.breadcrumb-item
							span.bullet.bg-gray-400.w-5px.h-2px
						li.breadcrumb-item.text-muted Push Notification
		#kt_app_content.app-content.flex-column-fluid
			#kt_app_content_container.app-container.container-xxl
				.card
					.card-header.border-0.pt-6
						.card-title
							h2 Customers
					.card-body.pt-0.text-center
						if noOfUsers >0 &&  _id
							h5 Found #{noOfUsers} Customers
							.btn.btn-primary.mt-5mb-5(data-bs-toggle="modal" data-bs-target="#kt_push_notification_modal") Push Notification to them
						else 
							h5 No Customers found


				#kt_push_notification_modal.modal.fade(tabindex='-1' aria-hidden='true')
					.modal-dialog.modal-dialog-centered.mw-650px
						.modal-content
							.modal-header
								h2.fw-bold Create a Notification
								.btn.btn-icon.btn-sm.btn-active-icon-primary(data-bs-dismiss="modal")
									span.svg-icon.svg-icon-1
										svg(width='24' height='24' viewbox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg')
											rect(opacity='0.5' x='6' y='17.3137' width='16' height='2' rx='1' transform='rotate(-45 6 17.3137)' fill='currentColor')
											rect(x='7.41422' y='6' width='16' height='2' rx='1' transform='rotate(45 7.41422 6)' fill='currentColor')
							.modal-body.scroll-y.mx-5.mx-xl-15.my-7
								form.es-form(action='/admin/ecommerce/customers/push-notification/send' method="post" data-kt-redirect-url='/admin/ecommerce/customers/push-notification')
									input(type="hidden" value=_id name="_id")
									.row.mb-6
										label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Title
										.col-lg-8.fv-row
											input.form-control.form-control-lg.form-control-solid(type='text' name='title' placeholder='Title' )
											.fv-plugins-message-container.invalid-feedback(id=`field-error-title`)
									.row.mb-6
										label.col-lg-4.col-form-label.required.fw-semibold.fs-6 Content
										.col-lg-8.fv-row
											textarea.form-control.form-control-lg.form-control-solid(type='text' name='content' placeholder='Content' )
											.fv-plugins-message-container.invalid-feedback(id=`field-error-content`)
									.text-center
										button.btn.btn-sm.btn-success.form-submit-btn(type='submit')
											span.label Save
											span.preloader.d-none Saving...




