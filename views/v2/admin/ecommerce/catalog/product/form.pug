extends ../../../layouts/master.pug

block csslib
	link(href='/admin/assets/plugins/custom/datatables/datatables.bundle.css' rel='stylesheet' type='text/css')

block jslib
	// begin::Vendors Javascript(used by this page)
	script(src='/admin/assets/plugins/custom/datatables/datatables.bundle.js')
	script(src='/admin/assets/plugins/custom/formrepeater/formrepeater.bundle.js')
	// end::Vendors Javascript
	// begin::Custom Javascript(used by this page)
	//- script(src='/admin/assets/js/custom/apps/ecommerce/catalog/save-product.js')
	script(src='/admin/assets/js/widgets.bundle.js')
	script(src='/admin/assets/js/custom/widgets.js')
	script(src='/admin/assets/js/custom/apps/chat/chat.js')
	script(src='/admin/assets/js/custom/utilities/modals/upgrade-plan.js')
	script(src='/admin/assets/js/custom/utilities/modals/create-app.js')
	script(src='/admin/assets/js/custom/utilities/modals/users-search.js')

	// CKEditor Build Bundles
	script(src='/admin/assets/plugins/custom/ckeditor/ckeditor-classic.bundle.js')

	// Form Submission Script
	script(src='/common/js/form-data-json.min.js')
	script(src='/common/js/es-form.js')


block customScript
	script.

		document.querySelectorAll('.content_wysiwyg').forEach(function(e) {
			ClassicEditor
			.create(document.querySelector(`#${e.getAttribute('id')}`))
			.then(editor => {
			})
			.catch(error => {
			console.error(error);
			});
		})

block content
	.d-flex.flex-column.flex-column-fluid
		#kt_app_toolbar.app-toolbar.py-3.py-lg-6
			#kt_app_toolbar_container.app-container.container-xxl.d-flex.flex-stack
				.page-title.d-flex.flex-column.justify-content-center.flex-wrap.me-3
					h1.page-heading.d-flex.text-dark.fw-bold.fs-3.flex-column.justify-content-center.my-0
						| Product
						| Form
					ul.breadcrumb.breadcrumb-separatorless.fw-semibold.fs-7.my-0.pt-1
						li.breadcrumb-item.text-muted
							a.text-muted.text-hover-primary(href='/admin/dashboard') Home
						li.breadcrumb-item
							span.bullet.bg-gray-400.w-5px.h-2px
						li.breadcrumb-item.text-muted eCommerce
						li.breadcrumb-item
							span.bullet.bg-gray-400.w-5px.h-2px
						li.breadcrumb-item.text-muted Catalog
				//- .d-flex.align-items-center.gap-2.gap-lg-3
					.m-0
						a.btn.btn-sm.btn-flex.bg-body.btn-color-gray-700.btn-active-color-primary.fw-bold(href='#' data-kt-menu-trigger='click' data-kt-menu-placement='bottom-end')
							span.svg-icon.svg-icon-6.svg-icon-muted.me-1
								svg(width='24' height='24' viewbox='0 0 24 24' fill='none' xmlns='http://www.w3.org/2000/svg')
									path(d='M19.0759 3H4.72777C3.95892 3 3.47768 3.83148 3.86067 4.49814L8.56967 12.6949C9.17923 13.7559 9.5 14.9582 9.5 16.1819V19.5072C9.5 20.2189 10.2223 20.7028 10.8805 20.432L13.8805 19.1977C14.2553 19.0435 14.5 18.6783 14.5 18.273V13.8372C14.5 12.8089 14.8171 11.8056 15.408 10.964L19.8943 4.57465C20.3596 3.912 19.8856 3 19.0759 3Z' fill='currentColor')
							| &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Filter
						#kt_menu_62c3e31d34e80.menu.menu-sub.menu-sub-dropdown.w-250px.w-md-300px(data-kt-menu='true')
							.px-7.py-5
								.fs-5.text-dark.fw-bold Filter Options
							.separator.border-gray-200
							.px-7.py-5
								.mb-10
									label.form-label.fw-semibold Status:
									div
										select.form-select.form-select-solid(data-kt-select2='true' data-placeholder='Select option' data-dropdown-parent='#kt_menu_62c3e31d34e80' data-allow-clear='true')
											option
											option(value='1') Approved
											option(value='2') Pending
											option(value='2') In Process
											option(value='2') Rejected
								.mb-10
									label.form-label.fw-semibold Member Type:
									.d-flex
										label.form-check.form-check-sm.form-check-custom.form-check-solid.me-5
											input.form-check-input(type='checkbox' value='1')
											span.form-check-label Author
										label.form-check.form-check-sm.form-check-custom.form-check-solid
											input.form-check-input(type='checkbox' value='2' checked='checked')
											span.form-check-label Customer
								.mb-10
									label.form-label.fw-semibold Notifications:
									.form-check.form-switch.form-switch-sm.form-check-custom.form-check-solid
										input.form-check-input(type='checkbox' value='' name='notifications' checked='checked')
										label.form-check-label Enabled
								.d-flex.justify-content-end
									button.btn.btn-sm.btn-light.btn-active-light-primary.me-2(type='reset' data-kt-menu-dismiss='true') Reset
									button.btn.btn-sm.btn-primary(type='submit' data-kt-menu-dismiss='true') Apply
					a.btn.btn-sm.fw-bold.btn-primary(href='#' data-bs-toggle='modal' data-bs-target='#kt_modal_create_app') Create
		#kt_app_content.app-content.flex-column-fluid
			#kt_app_content_container.app-container.container-xxl
				form#kt_ecommerce_add_product_form.es-form.form.d-flex.flex-column.flex-lg-row(action=`/admin/ecommerce/catalog/products/save` data-kt-redirect-url=`/admin/ecommerce/catalog/products`  method='post')
					input(hidden name="method" value="add")
					.d-flex.flex-column.gap-7.gap-lg-10.w-100.w-lg-300px.mb-7.me-lg-10
						//- .card.card-flush
							.card-header
								.card-title
									h3 Default Image
							.card-body.text-center.pt-0
								style.
									.image-input-placeholder {
									background-image: url('/admin/assets/media/svg/files/blank-image.svg');
									}
									[data-theme="dark"] .image-input-placeholder {
									background-image: url('/admin/assets/media/svg/files/blank-image-dark.svg');
									}
								.mt-0
									.image-input.image-input-empty.image-input-outline.image-input-placeholder.mb-3(data-kt-image-input='true' style='<br /> <b>Warning</b>: Undefined variable $imageBg in <b>C:\wamp64\www\keenthemes\core\html\dist\view\pages\apps\ecommerce\catalog\edit-product\_thumbnail.php</b> on line <b>30</b><br />')
										.image-input-wrapper.w-150px.h-150px
										label.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='change' data-bs-toggle='tooltip' title='Change avatar')
											i.bi.bi-pencil-fill.fs-7
											input(type='file' name='default_image' accept='.png, .jpg, .jpeg')
										span.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='cancel' data-bs-toggle='tooltip' title='Cancel avatar')
											i.bi.bi-x.fs-2
										span.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='remove' data-bs-toggle='tooltip' title='Remove avatar')
											i.bi.bi-x.fs-2
								.fv-plugins-message-container.invalid-feedback(id=`field-error-default_image`)
						//- .card.card-flush
							.card-header
								.card-title
									h3 Featured Image
							.card-body.text-center.pt-0
								.mt-0
									.image-input.image-input-empty.image-input-outline.image-input-placeholder.mb-3(data-kt-image-input='true' style='<br /> <b>Warning</b>: Undefined variable $imageBg in <b>C:\wamp64\www\keenthemes\core\html\dist\view\pages\apps\ecommerce\catalog\edit-product\_thumbnail.php</b> on line <b>30</b><br />')
										.image-input-wrapper.w-150px.h-150px
										label.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='change' data-bs-toggle='tooltip' title='Change avatar')
											i.bi.bi-pencil-fill.fs-7
											input(type='file' name='featured_image' accept='.png, .jpg, .jpeg')
										span.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='cancel' data-bs-toggle='tooltip' title='Cancel avatar')
											i.bi.bi-x.fs-2
										span.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='remove' data-bs-toggle='tooltip' title='Remove avatar')
											i.bi.bi-x.fs-2
								.fv-plugins-message-container.invalid-feedback(id=`field-error-featured_image`)
						.card.card-flush.py-4
							.card-header
								.card-title
									h3  Product Type
							.card-body.pt-0
								.column
									.col.d-flex.text-start.p-6
										span.form-check.form-check-custom.form-check-solid.form-check-sm.align-items-start(data-kt-button='true')
											input.form-check-input(type='radio' id="regular" name='product_type' value='regular' checked='checked')
										span.ms-5
											label.form-label(for="regular") Regular
									.col.d-flex.text-start.p-6
										span.form-check.form-check-custom.form-check-solid.form-check-sm.align-items-start(data-kt-button='true')
											input.form-check-input(type='radio' name='product_type' id="free_product" value='free_product' )
										span.ms-5
											label.form-label(for="free_product") Free product
									if ecommerceSettings &&  ecommerceSettings.semnox_free_toy_available
										.col.d-flex.text-start.p-6
											span.form-check.form-check-custom.form-check-solid.form-check-sm.align-items-start(data-kt-button='true')
												input.form-check-input(type='radio' name='product_type' id="free_toy" value='free_toy' )
											span.ms-5
												label.form-label(for="free_toy") Free Toy
						.card.card-flush.py-4
							.card-header
								.card-title
									h3 Status
							.card-body.pt-0
								select#kt_ecommerce_add_product_status_select.form-select.mb-2(data-control='select2' name="published" data-hide-search='true' data-placeholder='Select status')
									option
									option(value='false' selected='selected') Un-Published
									option(value='true' ) Published
								.text-muted.fs-7 Set the product status.
						.card.card-flush.py-4
							.card-header
								.card-title
									h3 Position
							.card-body.pt-0
								input.form-control(type='number' placeholder='Enter position'  name=`position` value="0")
								.fv-plugins-message-container.invalid-feedback(id=`field-error-position`)
						.card.card-flush.py-4
							.card-body.pt-0
								.column
									.col.d-flex.text-start.pt-10
										span.form-check.form-check-custom.form-check-solid.form-check-sm.align-items-start(data-kt-button='true')
											input.form-check-input(type='checkbox' id="featured" name='featured' value='true')
										span.ms-5
											label.form-label(for="featured") Featured Product
												span.badge.badge-light-warning
													small (Will List On Home API)
					.d-flex.flex-column.flex-row-fluid.gap-7.gap-lg-10
						.tab-content
							#kt_ecommerce_add_product_general.tab-pane.fade.show.active(role='tab-panel')
								.d-flex.flex-column.gap-7.gap-lg-10
									.card.card-flush.py-4
										.card-header
											.card-title
												h2.fw-bold General
											.card-toolbar
												button.btn.btn-sm.btn-success.form-submit-btn(type='submit')
													span.label Save
													span.preloader.d-none Saving...
										.card-body.pt-0
											ul.nav.nav-tabs.nav-line-tabs.mb-5.fs-6
												each brandLanguage, i in authAdmin.selected_brand.languages
													li.nav-item
														a.nav-link(class= (i== 0 ? 'active' : '') data-bs-toggle='tab' href=`#kt_tab_pane_${brandLanguage.prefix}`) #{brandLanguage.name}
											#myTabContent.tab-content.tab-content-fields
												each brandLanguage, i in authAdmin.selected_brand.languages
													.tab-pane.fade(class= (i== 0 ? 'active show' : '') role='tabpanel' id=`kt_tab_pane_${brandLanguage.prefix}`)
														.d-flex.flex-column.mb-8.fv-row.fv-plugins-icon-container
															// begin::Label
															label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
																span.required  Product Name (#{brandLanguage.prefix})
																i.fas.fa-exclamation-circle.ms-2.fs-7(data-bs-toggle='tooltip' aria-label='Specify a target name for future usage and reference' data-kt-initialized='1')
															// end::Label
															input.form-control.mb-2(type='text' name=`name[${brandLanguage.prefix}]` placeholder='Product name' value='')
															.fv-plugins-message-container.invalid-feedback(id=`field-error-name_${brandLanguage.prefix}`)
															div
																// begin::Label
																label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
																	span.required  Description (#{brandLanguage.prefix})
																	i.fas.fa-exclamation-circle.ms-2.fs-7(data-bs-toggle='tooltip' aria-label='Specify a target name for future usage and reference' data-kt-initialized='1')
																// end::Label
																textarea.content_wysiwyg(name=`description[${brandLanguage.prefix}]` id=`wysiwyg-${brandLanguage.prefix}-${i}`)
															.fv-plugins-message-container.mt-2.invalid-feedback(id=`field-error-description_${brandLanguage.prefix}`)
															div
																// begin::Label
																label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
																	span  Terms & Conditions (#{brandLanguage.prefix})
																	i.fas.fa-exclamation-circle.ms-2.fs-7(data-bs-toggle='tooltip' aria-label='Specify a target name for future usage and reference' data-kt-initialized='1')
																// end::Label
																textarea.content_wysiwyg(name=`terms_and_conditions[${brandLanguage.prefix}]` id=`wysiwyg-${brandLanguage.prefix}-${i+1}`)
															.fv-plugins-message-container.mt-2.invalid-feedback(id=`field-error-terms_and_conditions_${brandLanguage.prefix}`)
															//- .d-flex.flex-column.gap-7.gap-lg-10.w-100.w-lg-300px.mb-7.me-lg-10
															//- 	.card.card-flush
															//- 		.card-header
															//- 			.card-title
															//- 				h3 Default Image
															//- 		.card-body.text-center.pt-0
															label.d-flex.align-items-center.fs-6.fw-semibold.mb-2.mt-3
																span  Default Image (#{brandLanguage.prefix})
															style.
																.image-input-placeholder {
																background-image: url('/admin/assets/media/svg/files/blank-image.svg');
																}
																[data-theme="dark"] .image-input-placeholder {
																background-image: url('/admin/assets/media/svg/files/blank-image-dark.svg');
																}
															.mt-0
																.image-input.image-input-empty.image-input-outline.image-input-placeholder.mb-3(data-kt-image-input='true' style='<br /> <b>Warning</b>: Undefined variable $imageBg in <b>C:\wamp64\www\keenthemes\core\html\dist\view\pages\apps\ecommerce\catalog\edit-product\_thumbnail.php</b> on line <b>30</b><br />')
																	.image-input-wrapper.w-150px.h-150px
																	label.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='change' data-bs-toggle='tooltip' title='Change avatar')
																		i.bi.bi-pencil-fill.fs-7
																		input(type='file' name=`default_image.${brandLanguage.prefix}` accept='.png, .jpg, .jpeg')
																	span.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='cancel' data-bs-toggle='tooltip' title='Cancel avatar')
																		i.bi.bi-x.fs-2
																	span.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='remove' data-bs-toggle='tooltip' title='Remove avatar')
																		i.bi.bi-x.fs-2
															.fv-plugins-message-container.invalid-feedback(id=`field-error-default_image_${brandLanguage.prefix}`)
															label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
																span  Featured Image (#{brandLanguage.prefix})
															style.
																.image-input-placeholder {
																background-image: url('/admin/assets/media/svg/files/blank-image.svg');
																}
																[data-theme="dark"] .image-input-placeholder {
																background-image: url('/admin/assets/media/svg/files/blank-image-dark.svg');
																}
															.mt-0
																.image-input.image-input-empty.image-input-outline.image-input-placeholder.mb-3(data-kt-image-input='true' style='<br /> <b>Warning</b>: Undefined variable $imageBg in <b>C:\wamp64\www\keenthemes\core\html\dist\view\pages\apps\ecommerce\catalog\edit-product\_thumbnail.php</b> on line <b>30</b><br />')
																	.image-input-wrapper.w-150px.h-150px
																	label.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='change' data-bs-toggle='tooltip' title='Change avatar')
																		i.bi.bi-pencil-fill.fs-7
																		input(type='file' name=`featured_image.${brandLanguage.prefix}` accept='.png, .jpg, .jpeg')
																	span.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='cancel' data-bs-toggle='tooltip' title='Cancel avatar')
																		i.bi.bi-x.fs-2
																	span.btn.btn-icon.btn-circle.btn-active-color-primary.w-25px.h-25px.bg-body.shadow(data-kt-image-input-action='remove' data-bs-toggle='tooltip' title='Remove avatar')
																		i.bi.bi-x.fs-2
															.fv-plugins-message-container.invalid-feedback(id=`field-error-default_image_${brandLanguage.prefix}`)
									if moduleConfig.has_semnox == 'true'
										.card.card-flush.py-4
											.card-header
												.card-title
													h2 Semnox
											.card-body.pt-0
												label.form-label Semnox ID
												select.form-select.mb-2(data-control='select2' name="semnox_id" data-placeholder='Select an option' data-allow-clear='true' )
													option
													if semnoxProducts && semnoxProducts.length
														each product in semnoxProducts
															option(value=JSON.stringify({id:product.ProductId,name:product.ProductName})) #{product.ProductName}
													else 
														option No products found
												.fv-plugins-message-container.invalid-feedback(id=`field-error-semnox_id`)
												//- .text-muted.fs-7.mb-7 Select semnox id
									.card.card-flush.py-4
										.card-header
											.card-title
												h2 Categories
										.card-body.pt-0
											select.form-select.mb-2(data-control='select2' name="category" data-placeholder='Select category' data-allow-clear='true' multiple='multiple')
												each cat,i in categories
													option(value=`${cat._id}` ) #{cat.name.en}
											.fv-plugins-message-container.invalid-feedback(id=`field-error-category`)
											//- .text-muted.fs-7.mb-7 Add product to a category.
									.card.card-flush.py-4
										.card-header
											.card-title
												h2 Pricing
										.card-body.pt-0
											.mb-10.fv-row
												label.required.form-label Base Price
												input.form-control.mb-2(type='text' name='actual_price' placeholder='Product price' value='')
												.fv-plugins-message-container.invalid-feedback(id=`field-error-actual_price`)
											.mb-10.fv-row
												label.required.form-label Sale Price
												input.form-control.mb-2(type='text' name='sales_price' placeholder='Product sales price' value='')
												.fv-plugins-message-container.invalid-feedback(id=`field-error-sales_price`)
									.card.card-flush.py-4
										.card-header
											.card-title
												h2 PAM
										.card-body.pt-0
											.mb-10.fv-row
												label.required.form-label Is a Membership
												input.form-check.mb-2(type='checkbox' name='is_membership' placeholder='Is a Membership' value= 'true')
												.fv-plugins-message-container.invalid-feedback(id=`field-error-actual_price`)
											.mb-10.fv-row
												label.required.form-label PAM Product ID
												select.form-select.mb-2(data-control='select2' name="valid_pam_ids" data-placeholder='Select Pam products' data-allow-clear='true' multiple='multiple')
													each pam,i in pamMemberships
														option(value=`${pam.id}`) #{pam.membership_name}
														.fv-plugins-message-container.invalid-feedback(id=`field-error-valid_pam_ids`)
														//- .text-muted.fs-7.mb-7 Add product to a category.
