extends ../../layouts/master.pug

block csslib
	link(href='/admin/assets/plugins/custom/fullcalendar/fullcalendar.bundle.css' rel='stylesheet' type='text/css')
	link(href='/admin/assets/plugins/custom/datatables/datatables.bundle.css' rel='stylesheet' type='text/css')
	link(href='/admin/assets/plugins/global/plugins.bundle.css' rel='stylesheet' type='text/css')
	link(href='/admin/assets/css/style.bundle.css' rel='stylesheet' type='text/css')

block jslib
	// begin::Vendors Javascript(used by this page)
	//- script(src='/admin/assets/plugins/custom/fullcalendar/fullcalendar.bundle.js')
	script(src='/admin/assets/plugins/custom/datatables/datatables.bundle.js')
	// end::Vendors Javascript
	// begin::Custom Javascript(used by this page)
	//- script(src='/admin/assets/js/custom/apps/subscriptions/add/advanced.js')
	//- script(src='/admin/assets/js/custom/apps/subscriptions/add/customer-select.js')
	//- script(src='/admin/assets/js/custom/apps/subscriptions/add/products.js')
	script(src='/admin/assets/js/widgets.bundle.js')
	script(src='/admin/assets/js/custom/widgets.js')
	//- script(src='/admin/assets/js/custom/apps/ecommerce/sales/save-order.js')
	script(src='/admin/assets/js/custom/apps/chat/chat.js')
	script(src='/admin/assets/js/custom/utilities/modals/upgrade-plan.js')
	script(src='/admin/assets/js/custom/utilities/modals/create-app.js')
	script(src='/admin/assets/js/custom/utilities/modals/new-card.js')
	script(src='/admin/assets/js/custom/utilities/modals/users-search.js')
	// end::Custom Javascript

	// CKEditor Build Bundles
	script(src='/admin/assets/plugins/custom/ckeditor/ckeditor-classic.bundle.js')

	script(src='/admin/assets/js/scripts.bundle.js')

	// Form Submission Script
	script(src='/common/js/form-data-json.min.js')
	script(src='/common/js/es-form.js')

	//- custom functions 
	script(src='/common/js/custom-functions.js')

block customScript
	script.
		document.querySelectorAll('.content_wysiwyg').forEach(function(e) {
			ClassicEditor
			.create(document.querySelector(`#${e.getAttribute('id')}`))
			.then(editor => {
			})
			.catch(error => {
			console.error(error);
			});
		})

		document.querySelectorAll('.kt_daterangepicker input').forEach((picker)=>{
			$(`#${picker.id}`).flatpickr({
				altInput: !0,
				altFormat: 'd F, Y',
				dateFormat: 'Y-m-dTH:i:00.000\\Z',
			})
		}) 

block content
	.d-flex.flex-column.flex-column-fluid
		#kt_app_toolbar.app-toolbar.py-3.py-lg-6
			#kt_app_toolbar_container.app-container.container-xxl.d-flex.flex-stack
				.page-title.d-flex.flex-column.justify-content-center.flex-wrap.me-3
					h1.page-heading.d-flex.text-dark.fw-bold.fs-3.flex-column.justify-content-center.my-0 Add New Store
					ul.breadcrumb.breadcrumb-separatorless.fw-semibold.fs-7.my-0.pt-1
						li.breadcrumb-item.text-muted
							a.text-muted.text-hover-primary(href=`/admin/cms/store`) Store
						li.breadcrumb-item
							span.bullet.bg-gray-400.w-5px.h-2px
						li.breadcrumb-item.text-muted Add New
				//- .d-flex.align-items-center.gap-2.gap-lg-3
				//- 	a.btn.btn-sm.fw-bold.btn-primary(href='#' data-bs-toggle='modal' data-bs-target='#kt_modal_create_app') Create
		#kt_app_content.app-content.flex-column-fluid
			#kt_app_content_container.app-container.container-xxl
				.d-flex.flex-column.flex-lg-row
					.flex-lg-row-fluid.me-lg-15.order-2.order-lg-1.mb-10.mb-lg-0
						form#kt_subscriptions_create_new.form.es-form(action=`/admin/cms/store/save` data-kt-redirect-url=`/admin/cms/store`  method='post')
							.card.card-flush.pt-3.mb-5.mb-lg-10
								.card-header
									.card-title
										h2.fw-bold Store Details 
									.card-toolbar
										button.btn.btn-sm.btn-success.form-submit-btn(type='submit')
											span.label Save
											span.preloader.d-none Saving...
								.card-body.pt-0
									ul.nav.nav-tabs.nav-line-tabs.mb-5.fs-6
										each brandLanguage, i in authAdmin.selected_brand.languages
											li.nav-item
												a.nav-link(class= (i== 0 ? 'active' : '') data-bs-toggle='tab' href=`#kt_tab_pane_${brandLanguage.prefix}`) #{brandLanguage.name}
									#myTabContent.tab-content.tab-content-fields
										each brandLanguage, i in authAdmin.selected_brand.languages
											.tab-pane.fade(class= (i== 0 ? 'active show' : '') role='tabpanel' id=`kt_tab_pane_${brandLanguage.prefix}`)
												.d-flex.flex-column.mb-8.fv-row.fv-plugins-icon-container.col-md-6
													label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
														span.required Name (#{brandLanguage.prefix})
													input.form-control(type='text' placeholder='Enter Id' name=`id` hidden value=store._id)
													input.form-control(type='text' placeholder='Enter Name' name=`name[${brandLanguage.prefix}]` value=`${store.name[brandLanguage.prefix]}`)
													.fv-plugins-message-container.invalid-feedback(id=`field-error-name_${brandLanguage.prefix}`)
												.row
													.d-flex.flex-column.mb-8.fv-row.fv-plugins-icon-container.col-md-6
														label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
															span.required Address (#{brandLanguage.prefix})
														textarea.form-control( cols="3" rows="2" name=`address[${brandLanguage.prefix}]`) #{store.address[brandLanguage.prefix]}
														.fv-plugins-message-container.invalid-feedback(id=`field-error-address_${brandLanguage.prefix}`)
													.d-flex.flex-column.mb-8.fv-row.fv-plugins-icon-container.col-md-6
														label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
															span.required City (#{brandLanguage.prefix})
														input.form-control(type='text' placeholder='Enter City' name=`city[${brandLanguage.prefix}]` value=`${store.city[brandLanguage.prefix]}`)
														.fv-plugins-message-container.invalid-feedback(id=`field-error-city_${brandLanguage.prefix}`)
												.d-flex.flex-column.mb-8.fv-row.fv-plugins-icon-container
													label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
														span.required Opening Hours (#{brandLanguage.prefix})
													textarea.content_wysiwyg(name=`opening_hours[${brandLanguage.prefix}]` id=`wysiwyg-${brandLanguage.prefix}-${i}`) !{store.opening_hours[brandLanguage.prefix]}
													.fv-plugins-message-container.invalid-feedback(id=`field-error-opening_hours_${brandLanguage.prefix}`)
									.row.mb-8.fv-row.fv-plugins-icon-container
										.col-md-6
											label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
												span Phone Number
											input.form-control(type='text' placeholder='Enter phone' name=`phone` value=`${store.contact.phone}`)
											.fv-plugins-message-container.invalid-feedback(id=`field-error-phone`)
										.col-md-6
											label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
												span Email
											input.form-control(type='text' placeholder='Enter email' name=`email` value=`${store.contact.email}`)
											.fv-plugins-message-container.invalid-feedback(id=`field-error-email`)
									.row.mb-8.fv-row.fv-plugins-icon-container
										.col-md-6
											label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
												span Latitude
											input.form-control(type='text' placeholder='Enter latitude' name=`lat` value=`${store.coordinates.lat || ""}`)
											.fv-plugins-message-container.invalid-feedback(id=`field-error-lat`)
										.col-md-6
											label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
												span Longitude
											input.form-control(type='text' placeholder='Enter longitude' name=`lng` value=`${store.coordinates.lng || ""}`)
											.fv-plugins-message-container.invalid-feedback(id=`field-error-lng`)
									//- .row.mb-8.fv-row.fv-plugins-icon-container
										.col-md-6
											label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
												span Weekdays Opening hours
											input.form-control(type='text' placeholder='Enter Opening Hours' name=`weekdays_opening_hours` value=`${store.opening_hours.weekdays || ""}`)
											.fv-plugins-message-container.invalid-feedback(id=`field-error-weekdays_opening_hours`)
										.col-md-6
											label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
												span Off Days Opening Hours
											input.form-control(type='text' placeholder='Enter Opening Hours' name=`offdays_opening_hours` value=`${store.opening_hours.weekdays || ""}`)
											.fv-plugins-message-container.invalid-feedback(id=`field-error-offdays_opening_hours`)
									.row.mb-8.fv-row.fv-plugins-icon-container
										.col-md-12
											label.d-flex.align-items-center.fs-6.fw-semibold.mb-2
												span Available Attractions
											select.form-select.mb-2(data-control='select2' name="attractions" data-placeholder='Select Attractions' data-allow-clear='true' multiple='multiple')
												each attraction,i in attractions
													option(value=`${attraction._id}` selected=store.attractions.includes(attraction._id) ) #{attraction.content.en.title}
											.fv-plugins-message-container.invalid-feedback(id=`field-error-attractions`)


